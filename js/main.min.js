$("._tab").click(function() {
    let parentBlock = $(this).parents("._tabs-parent")
    let tabId = $(this).attr("data-tab")
    $(parentBlock).find("._tab").removeClass("_active")
    $(this).addClass("_active")
    $(parentBlock).find(".tab-content").removeClass("_active")
    $(parentBlock).find(`.${tabId}`).addClass("_active")
})

$(".qa-card__show").click(function () {
    $(this).parents(".qa-card").toggleClass("_active")
    $(this).siblings(".qa-card__hidden").slideToggle()
})

function calc(){
    $('.cartcalc').each(function (i,el) {
        let plus = $(el).find(".ccalc-plus")
        let minus = $(el).find(".ccalc-minus")
        let input = $(el).find("input")

        $(minus).click(function(e) {
            let a = $(input).val();
            if (a > 1) {
                let b = +a - 1;
                $(input).val(b);
                $(input).trigger('change');
            } else {
                $(input).val(a);
            }
            setMinusBtnClickability()
            e.stopImmediatePropagation()
        });

        $(plus).click(function(e) {
            let a = $(input).val();
            let b = +a + 1;
            $(input).val(b);
            $(input).trigger('change');
            setMinusBtnClickability(this)
            e.stopImmediatePropagation()
        });

        function setMinusBtnClickability() {
            let val = +$(input).val()
            if(val === 1){
                $(minus).addClass("_disabled")
            } else{
                $(minus).removeClass("_disabled")
            }
        }

        setMinusBtnClickability()
    })
}
calc()

setConfigItems()
$("._select-config").click(function () {
    setConfigItems()
    closeModals()
})

function setConfigItems(){
    let inputs = $("._config-checks input")
    $(inputs).each(function (){
        let isChecked = $(this).prop("checked")
        let id = $(this).attr("data-id")
        let product = $(`.calc-product[data-id="${id}"]`)
        if(isChecked){
            $(product).addClass("_selected")
        } else{
            $(product).removeClass("_selected")
        }
    })


    let checkedInputs = $("._config-checks input:checked")
    let sumOfProductPrices = 0
    let sessionCount = +$(".calc .cartcalc input").val()
    let salePercent = +$("._price-with-sale").attr("data-sale")
    if($(checkedInputs).length === 0){
        $(".about-rent").addClass("_empty")
    } else{
        $(".about-rent").removeClass("_empty")
    }

    $(checkedInputs).each(function (){
        let price = +$(this).attr("data-price")
        sumOfProductPrices = sumOfProductPrices + price
    })

    $("._old-price").html(Math.round(sumOfProductPrices*sessionCount).toLocaleString())
    $("._price-with-sale").html(Math.round(sumOfProductPrices*sessionCount*(1 - salePercent)).toLocaleString())
}

$(".calc-product__remove").click(function () {
    let id = $(this).parents(".calc-product").attr("data-id")
    $(`._config-checks input[data-id="${id}"]`).prop("checked", false)
    setConfigItems()
})

$(".calc .cartcalc input").change(function () {
    setConfigItems()
})

$(".js-price").each(function (){
    let price = +$(this).html()
    console.log(price)
    $(this).html(price.toLocaleString())
})

$("._year").html(new Date().getFullYear())
$(".burger").click(function () {
    $(".header").toggleClass("_open")
    $("body").toggleClass("fixed-body")
})

$(".nav-item__show").click(function () {
    if(window.innerWidth>=1024){
        $("body").toggleClass("fixed-body")
        if($(this).parents(".nav-item").hasClass("_open")){
            $(".nav-item").removeClass("_open")
        } else{
            $(".nav-item").removeClass("_open")
            $(this).parents(".nav-item").addClass("_open")
        }
    } else{
        $(this).parents(".nav-item").toggleClass("_open")
        $(this).siblings(".dropdown-menu").slideToggle()
    }
})

$(".dropdown-menu__bg").click(function () {
    $(".nav-item").removeClass("_open")
    $("body").removeClass("fixed-body")
})

function fixHeader() {
    let scroll = $(window).scrollTop();
    let header = $(".header").height()

    if (scroll >= 2) {
        $(".header").addClass("_fix");
    } else {
        $(".header").removeClass("_fix");
    }
}

$(window).scroll(function() {
    fixHeader()
});
fixHeader()
function Sliders() {
    let SlidersArray = []

    let sliders = document.querySelectorAll(".slider")
    sliders.forEach((slider,index) => {
        slider.setAttribute("data-slider-id",index)

        SlidersArray[index] = new Swiper(`.slider[data-slider-id="${index}"] .swiper-container`, {
            slidesPerView: "auto",
            spaceBetween: 0,
            watchSlidesProgress: true,
            preventClicks :true,
            a11y: false,
            observer: true,
            observeParents: true,
            observeSlideChildren: true,

            navigation: {
                nextEl: `.slider[data-slider-id="${index}"] .swiper-button-next`,
                prevEl: `.slider[data-slider-id="${index}"] .swiper-button-prev`,
            },
            pagination: {
                el: `.slider[data-slider-id="${index}"] .swiper-pagination`,
                type: 'bullets',
                clickable: true,
            },
        })
    })
}

Sliders()

let fileInput = document.querySelector("[data-upload-id='file-input']")

if(fileInput){
    console.log(fileInput)
    const upload = new FileUploadWithPreview.FileUploadWithPreview('file-input');

    upload.options.multiple = true

    $(document).on('change', '.input-container input', function(e) {
        $(this).parents(".file-input").addClass("_uploaded")
    })

    $(document).on('click', '.image-preview-item-clear', function(e) {
        let count = $(this).parents(".file-input").find(".image-preview-item").length
        if(count === 1){
            $(this).parents(".file-input").removeClass("_uploaded")
        }
    })
}



let body = document.querySelector("body")
let modalTogglers = document.querySelectorAll("[data-modal]")
let modals = document.querySelectorAll(".modal")

modalTogglers.forEach(el => {
    el.onclick = function () {
        let modalId = el.getAttribute("data-modal")
        openModal(modalId)
    }
})

function closeModals() {
    modals.forEach(modal => {
        modal.classList.remove("_active")
        body.classList.remove("fixed-body2")
    })
}

function openModal(modalId) {
    closeModals()
    let modal = document.querySelector(`#${modalId}`)
    let closeButtons = modal.querySelectorAll(`._close-modal`)

    modal.classList.add("_active")
    body.classList.add("fixed-body2")


    closeButtons.forEach(btn => {
        btn.onclick = ()=> {
            modal.classList.remove("_active")
            body.classList.remove("fixed-body2")
        }
    })
}

var getScrollBarSize = (function() {
    var el = window.document.createElement('textarea'), style = {
        'visibility': 'hidden', 'position': 'absolute', 'zIndex': '-2147483647',
        'top': '-1000px', 'left': '-1000px', 'width': '1000px', 'height': '1000px',
        'overflow': 'scroll', 'margin': '0', 'border': '0', 'padding': '0'
    }, support = el.clientWidth !== undefined && el.offsetWidth !== undefined;

    for (var key in style) {
        if (style.hasOwnProperty(key)) {
            el.style[key] = style[key];
        }
    }

    return function() {
        var size = null;
        if (support && window.document.body) {
            window.document.body.appendChild(el);
            size = [el.offsetWidth - el.clientWidth, el.offsetHeight - el.clientHeight];
            window.document.body.removeChild(el);
        }

        document.documentElement.style.setProperty('--scrollWidth', `${size[0]}px`);
        return size;
    };
})();



$("._cookie-close").click(function () {
    $(".cookie-modal").removeClass("_active")
    localStorage.setItem("cookies", "true")
})

isAgreedCookies()

function isAgreedCookies(){
    let isAgreed = localStorage.getItem("cookies")
    if(isAgreed){
        $(".cookie-modal").removeClass("_active")
    } else{
        $(".cookie-modal").addClass("_active")
    }
}
window.addEventListener('DOMContentLoaded', () => {
    fix100vh();
    window.addEventListener('resize', () => {
        fix100vh();
        getScrollBarSize()
    })

    getScrollBarSize()

    $('input[type="tel"]').mask('+7 (999) 999-99-99', { autoclear: false }, { placeholder: '+7 (   )    -  -  ' });
})

function fix100vh() {
    let vh = window.innerHeight * 0.01;
    document.documentElement.style.setProperty('--vh', `${vh}px`);
}

//# sourceMappingURL=../sourcemaps/main.min.js.map
